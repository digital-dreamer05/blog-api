<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Auth Success</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main style="max-width: 640px; margin: 48px auto">
      <h2>Signing you in...</h2>
      <div id="msg"></div>
    </main>
    <script>
      function parseParams(src) {
        const p = new URLSearchParams(src.replace(/^#|^\?/, ''));
        const obj = {};
        for (const [k, v] of p.entries()) obj[k] = v;
        return obj;
      }
      const q = {
        ...parseParams(location.search),
        ...parseParams(location.hash),
      };
      if (q.accessToken && q.refreshToken) {
        localStorage.setItem('accessToken', q.accessToken);
        localStorage.setItem('refreshToken', q.refreshToken);
        document.getElementById('msg').textContent = 'Success! Redirecting...';
        setTimeout(() => location.replace('/'), 800);
      } else {
        document.getElementById('msg').textContent = 'Missing tokens.';
      }
    </script>
  </body>
</html>
