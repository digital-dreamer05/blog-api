<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Blog - Home</title>
    <link rel="stylesheet" href="/blog-frontend/assets/css/styles.css" />
  </head>
  <body>
    <header class="header">
      <div class="nav">
        <div class="brand">Blog</div>
        <a data-href="index.html">Home</a>
        <a data-href="create.html">Create</a>
        <div class="actions">
          <a class="btn" data-href="login.html">Login</a>
          <a class="btn" data-href="register.html">Register</a>
          <a class="btn primary" data-href="dashboard.html">Dashboard</a>
        </div>
      </div>
    </header>

    <main class="container">
      <h2 class="reveal-once">Latest Articles</h2>
      <div id="articles" class="grid"></div>
    </main>

    <script src="/blog-frontend/assets/js/config.js"></script>
    <script src="/blog-frontend/assets/js/api.js"></script>
    <script src="/blog-frontend/assets/js/ui.js"></script>
    <script>
      // apply basePath to all [data-href]
      document.addEventListener('click', (e) => {
        const a = e.target.closest('[data-href]');
        if (!a) return;
        e.preventDefault();
        const to = a.getAttribute('data-href');
        location.href = ui.appUrl(to);
      });
      (async function loadArticles() {
        const res = await api.get('/articles');
        const list = Array.isArray(res?.data) ? res.data : [];
        const el = document.getElementById('articles');
        if (!list.length) {
          el.innerHTML = '<div class="meta">No articles found.</div>';
          return;
        }
        el.innerHTML = list
          .map((a) => {
            const img = (
              api.baseUrl +
              '/' +
              (a.cover || 'images/covers/cover.png-1758009540815.png')
            ).replace(/(?<!:)\/\/+/, '/');
            const author = a.author?.name || a.author?.username || 'Unknown';
            return `
            <article class="card reveal-once">
              <img src="${img}" alt="cover" />
              <div class="p">
                <h3><a href="${ui.appUrl(
                  'article.html'
                )}?slug=${encodeURIComponent(a.slug)}">${a.title}</a></h3>
                <div class="meta">By ${author}</div>
              </div>
            </article>`;
          })
          .join('');
      })();
    </script>
  </body>
</html>

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Blog API - Home</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <header>
      <h1>Blog</h1>
      <nav>
        <a href="/">Home</a>
        <a href="/login.html">Login</a>
        <a href="/register.html">Register</a>
        <a href="/create.html">Create</a>
        <a href="/dashboard.html">Dashboard</a>
      </nav>
    </header>

    <main>
      <section>
        <h2>Latest Articles</h2>
        <div id="articles"></div>
      </section>
    </main>

    <script src="/js/config.js"></script>
    <script src="/js/api.js"></script>
    <script>
      (async function loadArticles() {
        const list = await api.get('/articles');
        const container = document.getElementById('articles');
        if (!list || !Array.isArray(list.data)) {
          container.textContent = 'No articles found';
          return;
        }
        container.innerHTML = list.data
          .map(
            (a) => `
        <article class="card">
          <img src="${(
            api.baseUrl +
            '/' +
            (a.cover || 'images/covers/cover.png-1758009540815.png')
          ).replace(/(?<!:)\/\/+/, '/')}" alt="cover" />
          <h3><a href="/article.html?slug=${encodeURIComponent(a.slug)}">${
              a.title
            }</a></h3>
          <div class="meta">By ${
            a.author?.name || a.author?.username || 'Unknown'
          }</div>
        </article>
      `
          )
          .join('');
      })();
    </script>
  </body>
</html>
