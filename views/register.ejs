<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Register - My Blog</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .auth-container {
        background: white;
        padding: 40px;
        border-radius: 10px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        width: 100%;
        max-width: 450px;
      }

      .logo {
        text-align: center;
        margin-bottom: 30px;
      }

      .logo h1 {
        font-size: 2.5em;
        color: #667eea;
        margin-bottom: 10px;
      }

      .logo p {
        color: #666;
        font-size: 0.95em;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #333;
        font-size: 0.9em;
      }

      input[type='text'],
      input[type='email'],
      input[type='password'] {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 5px;
        font-size: 1em;
        transition: border-color 0.3s ease;
      }

      input:focus {
        outline: none;
        border-color: #667eea;
      }

      .btn {
        width: 100%;
        padding: 14px;
        border: none;
        border-radius: 5px;
        font-size: 1em;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 10px;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      .btn-google {
        background: white;
        color: #333;
        border: 2px solid #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      .btn-google:hover {
        background: #f5f5f5;
      }

      .divider {
        text-align: center;
        margin: 25px 0;
        position: relative;
      }

      .divider::before {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        width: 100%;
        height: 1px;
        background: #e0e0e0;
      }

      .divider span {
        background: white;
        padding: 0 15px;
        position: relative;
        color: #999;
        font-size: 0.9em;
      }

      .switch-auth {
        text-align: center;
        margin-top: 20px;
        color: #666;
        font-size: 0.95em;
      }

      .switch-auth a {
        color: #667eea;
        text-decoration: none;
        font-weight: 600;
      }

      .switch-auth a:hover {
        text-decoration: underline;
      }

      .error-message {
        background-color: #fee;
        color: #c00;
        padding: 12px;
        border-radius: 5px;
        margin-bottom: 20px;
        font-size: 0.9em;
      }

      .success-message {
        background-color: #efe;
        color: #060;
        padding: 12px;
        border-radius: 5px;
        margin-bottom: 20px;
        font-size: 0.9em;
      }

      .home-link {
        text-align: center;
        margin-top: 20px;
      }

      .home-link a {
        color: #667eea;
        text-decoration: none;
        font-size: 0.9em;
      }

      .home-link a:hover {
        text-decoration: underline;
      }

      .helper-text {
        font-size: 0.8em;
        color: #999;
        margin-top: 5px;
      }
    </style>
  </head>
  <body>
    <div class="auth-container">
      <div class="logo">
        <h1>My Blog</h1>
        <p>Create your account</p>
      </div>

      <div id="errorMessage" class="error-message" style="display: none"></div>
      <div
        id="successMessage"
        class="success-message"
        style="display: none"
      ></div>

      <form id="registerForm">
        <div class="form-group">
          <label for="name">Full Name</label>
          <input
            type="text"
            id="name"
            name="name"
            required
            placeholder="Enter your full name"
          />
        </div>

        <div class="form-group">
          <label for="username">Username</label>
          <input
            type="text"
            id="username"
            name="username"
            required
            placeholder="Choose a username"
          />
          <div class="helper-text">Only letters, numbers, and underscores</div>
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input
            type="email"
            id="email"
            name="email"
            required
            placeholder="Enter your email"
          />
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <input
            type="password"
            id="password"
            name="password"
            required
            placeholder="Create a password"
          />
          <div class="helper-text">At least 8 characters</div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <input
            type="password"
            id="confirmPassword"
            name="confirmPassword"
            required
            placeholder="Re-enter your password"
          />
        </div>

        <button type="submit" class="btn btn-primary">Create Account</button>
      </form>

      <div class="divider">
        <span>OR</span>
      </div>

      <button class="btn btn-google" onclick="registerWithGoogle()">
        <svg width="20" height="20" viewBox="0 0 20 20">
          <path
            fill="#4285F4"
            d="M19.6 10.23c0-.82-.1-1.42-.25-2.05H10v3.72h5.5c-.15.96-.74 2.31-2.04 3.22v2.45h3.16c1.89-1.73 2.98-4.3 2.98-7.34z"
          />
          <path
            fill="#34A853"
            d="M13.46 15.13c-.83.59-1.96 1-3.46 1-2.64 0-4.88-1.74-5.68-4.15H1.07v2.52C2.72 17.75 6.09 20 10 20c2.7 0 4.96-.89 6.62-2.42l-3.16-2.45z"
          />
          <path
            fill="#FBBC05"
            d="M3.99 10c0-.69.12-1.35.32-1.97V5.51H1.07A9.973 9.973 0 000 10c0 1.61.39 3.14 1.07 4.49l3.24-2.52c-.2-.62-.32-1.28-.32-1.97z"
          />
          <path
            fill="#EA4335"
            d="M10 3.88c1.88 0 3.13.81 3.85 1.48l2.84-2.76C14.96.99 12.7 0 10 0 6.09 0 2.72 2.25 1.07 5.51l3.24 2.52C5.12 5.62 7.36 3.88 10 3.88z"
          />
        </svg>
        Sign up with Google
      </button>

      <div class="switch-auth">
        Already have an account? <a href="/login">Login</a>
      </div>

      <div class="home-link">
        <a href="/">‚Üê Back to Home</a>
      </div>
    </div>

    <script>
      const registerForm = document.getElementById('registerForm');
      const errorMessage = document.getElementById('errorMessage');
      const successMessage = document.getElementById('successMessage');

      registerForm.addEventListener('submit', async function (e) {
        e.preventDefault();

        const password = document.getElementById('password').value;
        const confirmPassword =
          document.getElementById('confirmPassword').value;

        if (password !== confirmPassword) {
          showError('Passwords do not match!');
          return;
        }

        const formData = {
          name: document.getElementById('name').value,
          username: document.getElementById('username').value,
          email: document.getElementById('email').value,
          password: password,
          passwordConfirm: confirmPassword,
        };

        try {
          const response = await fetch('/auth/register', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData),
          });

          const data = await response.json();

          if (response.ok) {
            localStorage.setItem('accessToken', data.accessToken);
            localStorage.setItem('refreshToken', data.refreshToken);

            showSuccess('Registration successful! Redirecting...');

            setTimeout(() => {
              window.location.href = '/';
            }, 1000);
          } else {
            showError(data.message || 'Registration failed. Please try again.');
          }
        } catch (error) {
          console.error('Error:', error);
          showError('An error occurred. Please try again.');
        }
      });

      function registerWithGoogle() {
        window.location.href = '/auth/google';
      }

      function showError(message) {
        errorMessage.textContent = message;
        errorMessage.style.display = 'block';
        successMessage.style.display = 'none';
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      function showSuccess(message) {
        successMessage.textContent = message;
        successMessage.style.display = 'block';
        errorMessage.style.display = 'none';
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    </script>
  </body>
</html>
